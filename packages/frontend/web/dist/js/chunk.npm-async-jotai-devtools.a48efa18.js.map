{"version":3,"file":"js/chunk.npm-async-jotai-devtools.a48efa18.js","mappings":"uSAOIA,EAAY,GACPC,EAAAA,GAAQ,+BAAgCA,EAE7CC,EAAY,GACP,CAACF,EAAUC,GAEhBE,EAAkB,GACb,mBAAoBF,EAEzBG,EAA+B,IACjC,GAAM,CAAEC,IAAAA,CAAG,CAAEC,IAAAA,CAAG,CAAEC,IAAAA,CAAG,CAAE,CAAGN,EACpBO,EAAiC,IAAIC,IACrCC,EAAsC,IAAIC,QAC1CC,EAAqC,CAACC,EAAMC,KAChD,IAAMC,EAAaL,EAAoBH,GAAG,CAACM,EACjB,WAAtB,OAAOE,IACLA,EAAa,EACfL,EAAoBJ,GAAG,CAACO,EAAME,EAAa,GAE3CL,EAAoBM,MAAM,CAACH,GAE7BC,MAEJ,EACMG,EAA+B,IACnC,IAAMF,EAAaL,EAAoBH,GAAG,CAACM,GAC3CH,EAAoBJ,GAAG,CAACO,EAAM,CAACE,GAAc,GAAK,EACpD,EA4DA,OA3DAd,EAAMI,GAAG,CAAG,CAAC,GAAGa,KACd,IAAMC,EAAQd,KAAOa,GAErB,OADAV,EAAeY,OAAO,CAAC,GAAOC,EAAE,CAAEC,KAAM,KAAM,IACvC,KACLH,IACAP,EAAmCM,CAAI,CAAC,EAAE,EAC1CV,EAAeY,OAAO,CAAC,GAAOC,EAAE,CAAEC,KAAM,OAAQ,GAClD,CACF,EACArB,EAAMM,GAAG,CAAG,CAAC,GAAGW,KACd,IAAMK,EAAQhB,KAAOW,GAWrB,OAVAN,EAAmCM,CAAI,CAAC,EAAE,CAAE,KACtCK,aAAiBC,SACnBD,EAAME,IAAI,CAAC,KACTD,QAAQE,OAAO,GAAGD,IAAI,CAAC,KACrBjB,EAAeY,OAAO,CAAC,GAAOC,EAAE,CAAEC,KAAM,WAAY,GACtD,EACF,EAEJ,GACAd,EAAeY,OAAO,CAAC,GAAOC,EAAE,CAAEC,KAAM,KAAM,IACvCC,CACT,EACAtB,EAAMK,GAAG,CAAG,CAAC,GAAGY,KACd,IAAMK,EAAQjB,KAAOY,GAGrB,OAFAD,EAA6BC,CAAI,CAAC,EAAE,EACpCV,EAAeY,OAAO,CAAC,GAAOC,EAAE,CAAEC,KAAM,KAAM,IACvCC,CACT,EACAtB,EAAM0B,cAAc,CAAG,IACrBnB,EAAeoB,GAAG,CAACP,GACZ,KACLb,EAAeQ,MAAM,CAACK,EACxB,GAEFpB,EAAM4B,eAAe,CAAG,IACf5B,EAAM6B,sBAAsB,GAErC7B,EAAM8B,YAAY,CAAG,IACnB,IAAMC,EAAS/B,EAAMgC,0BAA0B,GAAG1B,GAAG,CAACM,GACtD,GAAImB,EACF,MAAO,CAAEE,EAAGF,EAAOE,CAAC,CAAEC,EAAGH,EAAOG,CAAC,CAAEC,EAAG,IAAI3B,IAAIuB,EAAOI,CAAC,CAACC,IAAI,GAAI,CAGnE,EACApC,EAAMqC,mBAAmB,CAAG,IAC1B,IAAMN,EAAS/B,EAAMgC,0BAA0B,GAAG1B,GAAG,CAACM,GACtD,GAAImB,GAAUA,EAAOO,CAAC,CACpB,MAAO,CACLlB,EAAGW,EAAOO,CAAC,CAAClB,CAAC,CACbmB,EAAGR,EAAOO,CAAC,CAACC,CAAC,CAInB,EACAvC,EAAMwC,YAAY,CAAG,IACnBxC,EAAMyC,kBAAkB,CAACC,GACzBnC,EAAeY,OAAO,CAAC,GAAOC,EAAE,CAAEC,KAAM,SAAU,GACpD,EACOrB,CACT,EACI2C,EAA+B,IACjC,GAAI,wBAAyB3C,GAAS,0BAA2BA,GAAS,uBAAwBA,GAAS,oBAAqBA,GAAS,sBAAuBA,EAAO,CACrK,GAAM,CACJ4C,oBAAAA,CAAmB,CACnBC,sBAAAA,CAAqB,CACrBC,mBAAAA,CAAkB,CAClBC,gBAAAA,CAAe,CACfC,kBAAAA,CAAiB,CAClB,CAAGhD,CACJA,CAAAA,EAAM0B,cAAc,CAAG,GAedkB,EAdI,IACLK,CAAAA,UAAAA,EAAO5B,IAAI,EAAgB4B,gBAAAA,EAAO5B,IAAI,GACxCD,EAAE,CAAEC,KAAM,KAAM,GAEE,QAAhB4B,EAAO5B,IAAI,EACbD,EAAE,CAAEC,KAAM,KAAM,GAEE,UAAhB4B,EAAO5B,IAAI,EACbD,EAAE,CAAEC,KAAM,OAAQ,GAEA,YAAhB4B,EAAO5B,IAAI,EACbD,EAAE,CAAEC,KAAM,SAAU,EAExB,EAC+B,GAEjCrB,EAAM4B,eAAe,CAAG,IACfiB,IAET7C,EAAM8B,YAAY,CAAG,IACnB,IAAMC,EAASe,EAAmBlC,GAClC,GAAImB,EAAQ,CACV,IAAMI,EAAI,IAAI3B,IAAIuB,EAAOI,CAAC,CAACC,IAAI,UAE/B,CADAD,EAAEpB,MAAM,CAACH,GACL,MAAOmB,GACF,CAAEE,EAAGF,EAAOE,CAAC,CAAEE,EAAAA,CAAE,EAEtB,MAAOJ,EACF,CAAEG,EAAGH,EAAOG,CAAC,CAAEC,EAAAA,CAAE,EAE1B,MACF,CACF,EACAnC,EAAMqC,mBAAmB,CAAG,GACVU,EAAgBnC,GAGlCZ,EAAMwC,YAAY,CAAG,IACnBQ,EAAkBN,EACpB,CAEF,CACA,OAAO1C,CACT,EACIkD,EAAsB,GACxB,EAAoBlD,GACXA,EAELD,EAAUC,GACLG,EAA6BH,GAElCC,EAAUD,GACL2C,EAA6B3C,GAE/BA,EAILmD,EAAmB,GAEdD,EADO,SAASE,IAKrBC,EAAqB,CAACC,EAAMC,IAAUD,EAAKE,IAAI,GAAKD,EAAMC,IAAI,EAAIC,MAAMC,IAAI,CAACJ,GAAMK,KAAK,CAAC,CAAC,CAACC,EAAO3B,EAAE,GAAK4B,OAAOC,EAAE,CAACP,EAAMjD,GAAG,CAACsD,GAAQ3B,IACrI8B,EAAyB,CAACT,EAAMC,IAAUD,EAAKE,IAAI,GAAKD,EAAMC,IAAI,EAAIC,MAAMC,IAAI,CAACJ,GAAMK,KAAK,CAAC,CAAC,CAACK,EAAGC,EAAM,IAC1G,IAAMC,EAASX,EAAMjD,GAAG,CAAC0D,GACzB,OAAOE,GAAUD,EAAMT,IAAI,GAAKU,EAAOV,IAAI,EAAIC,MAAMC,IAAI,CAACO,GAAON,KAAK,CAAC,GAAOO,EAAOC,GAAG,CAAChC,GAC3F,GACA,SAASiC,EAAiB,CACxBC,uBAAAA,EAAyB,EAAK,CAC9B,GAAGjB,EACJ,CAAG,CAAC,CAAC,EACJ,IAAMpD,EAAQmD,EAAiBC,GACzB,CAACkB,EAAeC,EAAiB,CAAG,KAAAC,QAAA,EAAS,IAAO,EACxD9B,OAAwB,IAAI+B,IAC5BC,WAA4B,IAAID,GAClC,IACME,EAAyB,KAAAC,MAAA,EAAO,IAsDtC,OArDAD,EAAuBE,OAAO,CAAG,GACjC,KAAAC,eAAA,EAAgB,KACdH,EAAuBE,OAAO,CAAG,EACnC,GACA,KAAAE,SAAA,EAAU,KACR,GAAI,CAAC7E,EAAgBF,GAAQ,OAC7B,IAAIgF,EAA6B,IAAIP,IACjCQ,EAAiC,IAAIR,IACnCS,EAAW,KACf,IAAMxC,EAAyB,IAAI+B,IAC7BC,EAA6B,IAAID,IACvC,IAAK,IAAM7D,KAAQZ,EAAM4B,eAAe,IAAM,EAAE,CAAE,CAChD,GAAI,CAACyC,GAA0BzD,EAAKuE,YAAY,CAC9C,SAEF,IAAMC,EAAYpF,EAAM8B,YAAY,CAAClB,GACjCwE,GACE,MAAOA,GACT1C,EAAOrC,GAAG,CAACO,EAAMwE,EAAUnD,CAAC,EAGhC,IAAMoD,EAAUrF,EAAMqC,mBAAmB,CAACzB,GAC1C,GAAIyE,EAAS,CACX,IAAIC,EAAiBD,EAAQ9C,CAAC,CACzB8B,GACHiB,CAAAA,EAAiB,IAAI9E,IACnBiD,MAAMC,IAAI,CAAC4B,EAAe5C,MAAM,IAAI6C,MAAM,CAIxC,GAAe,CAACC,EAAUL,YAAY,EAE1C,EAEFT,EAAWrE,GAAG,CAACO,EAAM0E,EACvB,CACF,CACA,GAAIjC,EAAmB2B,EAAYtC,IAAWqB,EAAuBkB,EAAgBP,GACnF,OAEFM,EAAatC,EACbuC,EAAiBP,EACjB,IAAMe,EAA0B,IAAMlB,EAAiB,CAAE7B,OAAAA,EAAQgC,WAAAA,CAAW,EACxEC,CAAAA,EAAuBE,OAAO,CAChCtD,QAAQE,OAAO,GAAGD,IAAI,CAACiE,GAEvBA,GAEJ,EACMC,EAAc1F,EAAM0B,cAAc,CAACwD,GAEzC,OADAA,IACOQ,CACT,EAAG,CAAC1F,EAAOqE,EAAuB,EAC3BC,CACT,CAIA,SAASqB,EAAqBvC,CAAO,EACnC,IAAMpD,EAAQmD,EAAiBC,GAC/B,MAAO,KAAAwC,WAAA,EACL,IACM1F,EAAgBF,IAClBA,EAAMwC,YAAY,CAACqD,EAASnD,MAAM,CAEtC,EACA,CAAC1C,EAAM,CAEX,CAUA,IAAI8F,EAAkB,GAAUlF,EAAKmF,UAAU,EAAInF,EAAKoF,QAAQ,GAC5DC,EAAmB,CAAC,CAACjG,EAAOkG,EAAM,GAAKrC,OAAOsC,WAAW,CAC3DD,EAAME,OAAO,CAAC,IACZ,IAAMf,EAAUnF,EAAgBF,IAAUA,EAAMqC,mBAAmB,CAACzB,GACpE,GAAI,CAACyE,EACH,MAAO,EAAE,CAEX,IAAMX,EAAaW,EAAQ9C,CAAC,CACtB6C,EAAYpF,EAAM8B,YAAY,CAAClB,IAAS,CAAC,EAC/C,MAAO,CACL,CACEkF,EAAgBlF,GAChB,CACE,GAAG,MAAOwE,GAAa,CAAEiB,MAAOjB,EAAUlD,CAAC,CAAE,CAC7C,GAAG,MAAOkD,GAAa,CAAE9D,MAAO8D,EAAUnD,CAAC,CAAE,CAC7CyC,WAAYjB,MAAMC,IAAI,CAACgB,GAAY4B,GAAG,CAACR,EACzC,EACD,CACF,IAGDS,EAAqB,IACvB,IAAMC,EAAUpD,GAASoD,SAAW,GAC9BxG,EAAQmD,EAAiBC,GACzB,CAAC8C,EAAOO,EAAS,CAAG,KAAAjC,QAAA,EAAU,EAAE,EAChCG,EAAyB,KAAAC,MAAA,EAAQ,GACvCD,CAAAA,EAAuBE,OAAO,CAAG,GACjC,KAAAC,eAAA,EAAiB,KACfH,EAAuBE,OAAO,CAAG,EACnC,GACA,KAAAE,SAAA,EAAW,KACT,GAAI,CAACyB,GAAW,CAACtG,EAAgBF,GAC/B,OAEF,IAAMkF,EAAW,KACf,IAAMO,EAA0B,IAAMgB,EAAShD,MAAMC,IAAI,CAAC1D,EAAM4B,eAAe,IAAM,EAAE,EACnF+C,CAAAA,EAAuBE,OAAO,CAChCtD,QAAQE,OAAO,GAAGD,IAAI,CAACiE,GAEvBA,GAEJ,EACMC,EAAc1F,EAAM0B,cAAc,CAACwD,GAEzC,OADAA,IACOQ,CACT,EAAG,CAACc,EAASxG,EAAM,EACnB,KAAA0G,aAAA,EAAc,CAAC1G,EAAOkG,EAAM,CAAED,EAChC,EAOIU,EAAwB,CAACC,EAAWC,KACtC,GAAKD,EAEL,OAAO/C,OAAOiD,MAAM,CADDF,EAAUG,OAAO,CAAC,CAAEF,KAAAA,CAAK,GACX,CAC/BG,WAAY,EACd,EACF,EAGIC,EAAoB,CAACT,EAAU,EAAqC,IACtE,GAAKA,EAQL,OALuBU,OAAOC,4BAA4B,EAS5D,SAASC,EAAgBC,CAAM,CAAEjE,CAAO,EACtC,GAAM,CAAEoD,QAAAA,CAAO,CAAEK,KAAAA,CAAI,CAAE,CAAGzD,GAAW,CAAC,EAChCwD,EAAYK,EAAkBT,GAC9B,CAAClF,EAAOgG,EAAS,CAAG,SAAQD,EAAQjE,GACpCmE,EAAY,KAAA3C,MAAA,EAAQtD,GACpBkG,EAAkB,KAAA5C,MAAA,EAAQ,IAC1B6C,EAAW,KAAA7C,MAAA,IACX8C,EAAWb,GAAQQ,EAAOtB,UAAU,EAAIsB,EAAOrB,QAAQ,GAC7D,KAAAjB,SAAA,EAAW,KACT,GAAI,CAAC6B,EACH,OAEF,IAAMe,EAAqB,IACzB,GAAI,mBAAOL,EAAyB,CAClCA,EAASM,GACT,MACF,CACAC,QAAQC,IAAI,CACV,oFACAT,EAEJ,EA8BA,OA7BAI,EAAS5C,OAAO,CAAG8B,EAAsBC,EAAWc,GAChCD,EAAS5C,OAAO,EAAEkD,UAAU,IAC9C,GAAIC,WAAAA,EAAQ3G,IAAI,EAAiB2G,EAAQC,OAAO,CAC9C,GAAI,CACFN,EAAmBO,KAAKC,KAAK,CAACH,EAAQC,OAAO,EAC/C,CAAE,MAAO/F,EAAG,CACV2F,QAAQxB,KAAK,CACX,mEACAnE,EAEJ,KACS8F,aAAAA,EAAQ3G,IAAI,EAAmB2G,EAAQI,KAAK,CACjDJ,CAAAA,EAAQC,OAAO,EAAE5G,OAAS,kBAAoB2G,EAAQC,OAAO,EAAE5G,OAAS,eAAc,IACxFmG,EAAgB3C,OAAO,CAAG,GAC1B8C,EAAmBO,KAAKC,KAAK,CAACH,EAAQI,KAAK,IAEpCJ,aAAAA,EAAQ3G,IAAI,EAAmB2G,EAAQC,OAAO,EAAE5G,OAAS,SAClEoG,EAAS5C,OAAO,EAAEwD,KAAKd,EAAU1C,OAAO,EACd,aAAjBmD,EAAQ3G,IAAI,EAAmB2G,EAAQC,OAAO,EAAE5G,OAAS,gBAElEiH,CADuBN,EAAQC,OAAO,CAACM,eAAe,EAAED,gBAAkB,EAAE,EAC7DnH,OAAO,CAAC,CAAC,CAAEiH,MAAAA,CAAK,CAAE,CAAEI,KAC7BA,IAAAA,EACFf,EAAS5C,OAAO,EAAEwD,KAAKD,GAEvBT,EAAmBS,EAEvB,EAEJ,EAEF,EAAG,CAACf,EAAQT,EAAWc,EAAUJ,EAAS,EAC1C,KAAAvC,SAAA,EAAW,KACJ0C,EAAS5C,OAAO,GAGrB0C,EAAU1C,OAAO,CAAGvD,EAChBmG,EAAS5C,OAAO,CAACmC,UAAU,EAC7BS,EAAS5C,OAAO,CAACwD,IAAI,CAAC/G,GACtBmG,EAAS5C,OAAO,CAACmC,UAAU,CAAG,IACrBQ,EAAgB3C,OAAO,CAChC2C,EAAgB3C,OAAO,CAAG,GAE1B4C,EAAS5C,OAAO,CAAC4D,IAAI,CACnB,CAAC,EAAEf,EAAS,GAAG,EAAE,IAAqBgB,OAAQC,cAAc,GAAG,CAAC,CAChErH,GAGN,EAAG,CAAC+F,EAAQT,EAAWc,EAAUpG,EAAM,CACzC,CAIA,IAAIsH,EAAmB,GAAUhI,EAAKmF,UAAU,CAAG,CAAC,EAAEnF,EAAK,CAAC,EAAEA,EAAKmF,UAAU,CAAC,CAAC,CAAG,CAAC,EAAEnF,EAAK,CAAC,CACvFiI,EAAmB,IACrB,IAAMnG,EAAS,CAAC,EAChB4B,EAAc5B,MAAM,CAACvB,OAAO,CAAC,CAACc,EAAGrB,KAC/B8B,CAAM,CAACkG,EAAiBhI,GAAM,CAAGqB,CACnC,GACA,IAAMyC,EAAa,CAAC,EAIpB,OAHAJ,EAAcI,UAAU,CAACvD,OAAO,CAAC,CAACgB,EAAGvB,KACnC8D,CAAU,CAACkE,EAAiBhI,GAAM,CAAG6C,MAAMC,IAAI,CAACvB,GAAGmE,GAAG,CAACsC,EACzD,GACO,CACLlG,OAAAA,EACAgC,WAAAA,CACF,CACF,EACA,SAASoE,EAAiBjC,CAAI,CAAEzD,CAAO,EACrC,GAAM,CAAEoD,QAAAA,CAAO,CAAE,CAAGpD,GAAW,CAAC,EAC1BwD,EAAYK,EAAkBT,GAC9BlC,EAAgBF,EAAiBhB,GACjC2F,EAAepD,EAAqBvC,GACpCoE,EAAkB,KAAA5C,MAAA,EAAQ,IAC1BoE,EAAc,KAAApE,MAAA,EAAQ,IACtB6C,EAAW,KAAA7C,MAAA,IACXqE,EAAY,KAAArE,MAAA,EAAQ,EAAE,EAC5B,KAAAG,SAAA,EAAW,KACT,GAAI,CAAC6B,EACH,OAEF,IAAMsC,EAAgB,CAACV,EAAQS,EAAUpE,OAAO,CAACsE,MAAM,CAAG,CAAC,IACzD,IAAMtD,EAAWoD,EAAUpE,OAAO,CAAC2D,GAAS,EAAIA,EAAQ,EAAE,CAC1D,GAAI,CAAC3C,EACH,MAAM,MAAU,gCAElB,OAAOA,CACT,CACA4B,CAAAA,EAAS5C,OAAO,CAAG8B,EAAsBC,EAAWC,GACpD,IAAMuC,EAAsB3B,EAAS5C,OAAO,EAAEkD,UAAU,IACtD,GACO,aADCC,EAAQ3G,IAAI,CAEhB,OAAQ2G,EAAQC,OAAO,EAAE5G,MACvB,IAAK,QACH,KACF,KAAK,SACHoG,EAAS5C,OAAO,EAAEwD,KAAKQ,EAAiBK,MACxCD,EAAUpE,OAAO,CAAG,EAAE,CACtB,KACF,KAAK,iBACL,IAAK,gBACH2C,EAAgB3C,OAAO,CAAG,GAC1BkE,EAAaG,EAAclB,EAAQC,OAAO,CAACoB,QAAQ,CAAG,IACtD,KACF,KAAK,kBACHL,EAAYnE,OAAO,CAAG,CAACmE,EAAYnE,OAAO,CAIpD,GACA,MAAO,KACL+B,GAAW0C,eACXF,KACF,CACF,EAAG,CAACxC,EAAWmC,EAAclC,EAAK,EAClC,KAAA9B,SAAA,EAAW,KACT,GAAK0C,EAAS5C,OAAO,EAGrB,GAAI4C,EAAS5C,OAAO,CAACmC,UAAU,CAAE,CAC/BS,EAAS5C,OAAO,CAACwD,IAAI,CAAC,KAAK,GAC3BZ,EAAS5C,OAAO,CAACmC,UAAU,CAAG,GAC9B,MACF,CACIQ,EAAgB3C,OAAO,CACzB2C,EAAgB3C,OAAO,CAAG,GACjBmE,EAAYnE,OAAO,GAC5BoE,EAAUpE,OAAO,CAAC0E,IAAI,CAACjF,GACvBmD,EAAS5C,OAAO,CAAC4D,IAAI,CACnB,CACEpH,KAAM,CAAC,EAAE4H,EAAUpE,OAAO,CAACsE,MAAM,CAAC,CAAC,CACnCK,UAAW,IAAqBd,OAAQC,cAAc,EACxD,EACAE,EAAiBvE,KAGvB,EAAG,CAACA,EAAc,CACpB,CCreA,IAAImF,EAAsE,IAAM,I","sources":["webpack://@affine/web/../../../node_modules/jotai-devtools/dist/chunk-2JP4LGQ6.esm.mjs","webpack://@affine/web/../../../node_modules/jotai-devtools/dist/index.esm.mjs"],"sourcesContent":["// src/utils/useAtomsSnapshot.ts\nimport { useEffect, useLayoutEffect, useRef, useState } from \"react\";\n\n// src/utils/hooks/useDevToolsStore.ts\nimport { useStore } from \"jotai\";\n\n// src/utils/internals/compose-with-devtools.ts\nvar isStoreV2 = (store) => {\n  return store ? \"dev4_get_internal_weak_map\" in store : false;\n};\nvar isStoreV1 = (store) => {\n  return !isStoreV2(store);\n};\nvar isDevToolsStore = (store) => {\n  return \"subscribeStore\" in store;\n};\nvar __composeV2StoreWithDevTools = (store) => {\n  const { sub, set, get } = store;\n  const storeListeners = /* @__PURE__ */ new Set();\n  const recentlySetAtomsMap = /* @__PURE__ */ new WeakMap();\n  const reduceCountOrRemoveRecentlySetAtom = (atom, onFound) => {\n    const foundCount = recentlySetAtomsMap.get(atom);\n    if (typeof foundCount === \"number\") {\n      if (foundCount > 1) {\n        recentlySetAtomsMap.set(atom, foundCount - 1);\n      } else {\n        recentlySetAtomsMap.delete(atom);\n      }\n      onFound?.();\n    }\n  };\n  const increaseCountRecentlySetAtom = (atom) => {\n    const foundCount = recentlySetAtomsMap.get(atom);\n    recentlySetAtomsMap.set(atom, (foundCount || 0) + 1);\n  };\n  store.sub = (...args) => {\n    const unsub = sub(...args);\n    storeListeners.forEach((l) => l({ type: \"sub\" }));\n    return () => {\n      unsub();\n      reduceCountOrRemoveRecentlySetAtom(args[0]);\n      storeListeners.forEach((l) => l({ type: \"unsub\" }));\n    };\n  };\n  store.get = (...args) => {\n    const value = get(...args);\n    reduceCountOrRemoveRecentlySetAtom(args[0], () => {\n      if (value instanceof Promise) {\n        value.then(() => {\n          Promise.resolve().then(() => {\n            storeListeners.forEach((l) => l({ type: \"async-get\" }));\n          });\n        });\n      }\n    });\n    storeListeners.forEach((l) => l({ type: \"get\" }));\n    return value;\n  };\n  store.set = (...args) => {\n    const value = set(...args);\n    increaseCountRecentlySetAtom(args[0]);\n    storeListeners.forEach((l) => l({ type: \"set\" }));\n    return value;\n  };\n  store.subscribeStore = (l) => {\n    storeListeners.add(l);\n    return () => {\n      storeListeners.delete(l);\n    };\n  };\n  store.getMountedAtoms = () => {\n    return store.dev4_get_mounted_atoms();\n  };\n  store.getAtomState = (atom) => {\n    const aState = store.dev4_get_internal_weak_map().get(atom);\n    if (aState) {\n      return { v: aState.v, e: aState.e, d: new Set(aState.d.keys()) };\n    }\n    return void 0;\n  };\n  store.getMountedAtomState = (atom) => {\n    const aState = store.dev4_get_internal_weak_map().get(atom);\n    if (aState && aState.m) {\n      return {\n        l: aState.m.l,\n        t: aState.m.t\n      };\n    }\n    return void 0;\n  };\n  store.restoreAtoms = (values) => {\n    store.dev4_restore_atoms(values);\n    storeListeners.forEach((l) => l({ type: \"restore\" }));\n  };\n  return store;\n};\nvar __composeV1StoreWithDevTools = (store) => {\n  if (\"dev_subscribe_store\" in store && \"dev_get_mounted_atoms\" in store && \"dev_get_atom_state\" in store && \"dev_get_mounted\" in store && \"dev_restore_atoms\" in store) {\n    const {\n      dev_subscribe_store,\n      dev_get_mounted_atoms,\n      dev_get_atom_state,\n      dev_get_mounted,\n      dev_restore_atoms\n    } = store;\n    store.subscribeStore = (l) => {\n      const cb = (action) => {\n        if (action.type === \"write\" || action.type === \"async-write\") {\n          l({ type: \"set\" });\n        }\n        if (action.type === \"sub\") {\n          l({ type: \"sub\" });\n        }\n        if (action.type === \"unsub\") {\n          l({ type: \"unsub\" });\n        }\n        if (action.type === \"restore\") {\n          l({ type: \"restore\" });\n        }\n      };\n      return dev_subscribe_store(cb, 2);\n    };\n    store.getMountedAtoms = () => {\n      return dev_get_mounted_atoms();\n    };\n    store.getAtomState = (atom) => {\n      const aState = dev_get_atom_state(atom);\n      if (aState) {\n        const d = new Set(aState.d.keys());\n        d.delete(atom);\n        if (\"v\" in aState) {\n          return { v: aState.v, d };\n        }\n        if (\"e\" in aState) {\n          return { e: aState.e, d };\n        }\n        return void 0;\n      }\n    };\n    store.getMountedAtomState = (atom) => {\n      const mounted = dev_get_mounted(atom);\n      return mounted;\n    };\n    store.restoreAtoms = (values) => {\n      dev_restore_atoms(values);\n    };\n    return store;\n  }\n  return store;\n};\nvar composeWithDevTools = (store) => {\n  if (isDevToolsStore(store)) {\n    return store;\n  }\n  if (isStoreV2(store)) {\n    return __composeV2StoreWithDevTools(store);\n  }\n  if (isStoreV1(store)) {\n    return __composeV1StoreWithDevTools(store);\n  }\n  return store;\n};\n\n// src/utils/hooks/useDevToolsStore.ts\nvar useDevToolsStore = (options) => {\n  const store = useStore(options);\n  return composeWithDevTools(store);\n};\n\n// src/utils/useAtomsSnapshot.ts\nvar isEqualAtomsValues = (left, right) => left.size === right.size && Array.from(left).every(([left2, v]) => Object.is(right.get(left2), v));\nvar isEqualAtomsDependents = (left, right) => left.size === right.size && Array.from(left).every(([a, dLeft]) => {\n  const dRight = right.get(a);\n  return dRight && dLeft.size === dRight.size && Array.from(dLeft).every((d) => dRight.has(d));\n});\nfunction useAtomsSnapshot({\n  shouldShowPrivateAtoms = false,\n  ...options\n} = {}) {\n  const store = useDevToolsStore(options);\n  const [atomsSnapshot, setAtomsSnapshot] = useState(() => ({\n    values: /* @__PURE__ */ new Map(),\n    dependents: /* @__PURE__ */ new Map()\n  }));\n  const duringReactRenderPhase = useRef(true);\n  duringReactRenderPhase.current = true;\n  useLayoutEffect(() => {\n    duringReactRenderPhase.current = false;\n  });\n  useEffect(() => {\n    if (!isDevToolsStore(store)) return;\n    let prevValues = /* @__PURE__ */ new Map();\n    let prevDependents = /* @__PURE__ */ new Map();\n    const callback = () => {\n      const values = /* @__PURE__ */ new Map();\n      const dependents = /* @__PURE__ */ new Map();\n      for (const atom of store.getMountedAtoms() || []) {\n        if (!shouldShowPrivateAtoms && atom.debugPrivate) {\n          continue;\n        }\n        const atomState = store.getAtomState(atom);\n        if (atomState) {\n          if (\"v\" in atomState) {\n            values.set(atom, atomState.v);\n          }\n        }\n        const mounted = store.getMountedAtomState(atom);\n        if (mounted) {\n          let atomDependents = mounted.t;\n          if (!shouldShowPrivateAtoms) {\n            atomDependents = new Set(\n              Array.from(atomDependents.values()).filter(\n                /* NOTE: This just removes private atoms from the dependents list,\n                  instead of hiding them from the dependency chain and showing\n                  the nested dependents of the private atoms. */\n                (dependent) => !dependent.debugPrivate\n              )\n            );\n          }\n          dependents.set(atom, atomDependents);\n        }\n      }\n      if (isEqualAtomsValues(prevValues, values) && isEqualAtomsDependents(prevDependents, dependents)) {\n        return;\n      }\n      prevValues = values;\n      prevDependents = dependents;\n      const deferrableAtomSetAction = () => setAtomsSnapshot({ values, dependents });\n      if (duringReactRenderPhase.current) {\n        Promise.resolve().then(deferrableAtomSetAction);\n      } else {\n        deferrableAtomSetAction();\n      }\n    };\n    const unsubscribe = store.subscribeStore(callback);\n    callback();\n    return unsubscribe;\n  }, [store, shouldShowPrivateAtoms]);\n  return atomsSnapshot;\n}\n\n// src/utils/useGotoAtomsSnapshot.ts\nimport { useCallback } from \"react\";\nfunction useGotoAtomsSnapshot(options) {\n  const store = useDevToolsStore(options);\n  return useCallback(\n    (snapshot) => {\n      if (isDevToolsStore(store)) {\n        store.restoreAtoms(snapshot.values);\n      }\n    },\n    [store]\n  );\n}\n\n// src/utils/useAtomsDebugValue.ts\nimport {\n  useDebugValue,\n  useEffect as useEffect2,\n  useLayoutEffect as useLayoutEffect2,\n  useRef as useRef2,\n  useState as useState2\n} from \"react\";\nvar atomToPrintable = (atom) => atom.debugLabel || atom.toString();\nvar stateToPrintable = ([store, atoms]) => Object.fromEntries(\n  atoms.flatMap((atom) => {\n    const mounted = isDevToolsStore(store) && store.getMountedAtomState(atom);\n    if (!mounted) {\n      return [];\n    }\n    const dependents = mounted.t;\n    const atomState = store.getAtomState(atom) || {};\n    return [\n      [\n        atomToPrintable(atom),\n        {\n          ...\"e\" in atomState && { error: atomState.e },\n          ...\"v\" in atomState && { value: atomState.v },\n          dependents: Array.from(dependents).map(atomToPrintable)\n        }\n      ]\n    ];\n  })\n);\nvar useAtomsDebugValue = (options) => {\n  const enabled = options?.enabled ?? process.env.NODE_ENV !== \"production\";\n  const store = useDevToolsStore(options);\n  const [atoms, setAtoms] = useState2([]);\n  const duringReactRenderPhase = useRef2(true);\n  duringReactRenderPhase.current = true;\n  useLayoutEffect2(() => {\n    duringReactRenderPhase.current = false;\n  });\n  useEffect2(() => {\n    if (!enabled || !isDevToolsStore(store)) {\n      return;\n    }\n    const callback = () => {\n      const deferrableAtomSetAction = () => setAtoms(Array.from(store.getMountedAtoms() || []));\n      if (duringReactRenderPhase.current) {\n        Promise.resolve().then(deferrableAtomSetAction);\n      } else {\n        deferrableAtomSetAction();\n      }\n    };\n    const unsubscribe = store.subscribeStore(callback);\n    callback();\n    return unsubscribe;\n  }, [enabled, store]);\n  useDebugValue([store, atoms], stateToPrintable);\n};\n\n// src/utils/useAtomDevtools.ts\nimport { useEffect as useEffect3, useRef as useRef3 } from \"react\";\nimport { useAtom } from \"jotai/react\";\n\n// src/utils/redux-extension/createReduxConnection.ts\nvar createReduxConnection = (extension, name) => {\n  if (!extension) return void 0;\n  const connection = extension.connect({ name });\n  return Object.assign(connection, {\n    shouldInit: true\n  });\n};\n\n// src/utils/redux-extension/getReduxExtension.ts\nvar getReduxExtension = (enabled = process.env.NODE_ENV !== \"production\") => {\n  if (!enabled) {\n    return void 0;\n  }\n  const reduxExtension = window.__REDUX_DEVTOOLS_EXTENSION__;\n  if (!reduxExtension && process.env.NODE_ENV !== \"production\") {\n    console.warn(\"Please install/enable Redux devtools extension\");\n    return void 0;\n  }\n  return reduxExtension;\n};\n\n// src/utils/useAtomDevtools.ts\nfunction useAtomDevtools(anAtom, options) {\n  const { enabled, name } = options || {};\n  const extension = getReduxExtension(enabled);\n  const [value, setValue] = useAtom(anAtom, options);\n  const lastValue = useRef3(value);\n  const isTimeTraveling = useRef3(false);\n  const devtools = useRef3();\n  const atomName = name || anAtom.debugLabel || anAtom.toString();\n  useEffect3(() => {\n    if (!extension) {\n      return;\n    }\n    const setValueIfWritable = (value2) => {\n      if (typeof setValue === \"function\") {\n        setValue(value2);\n        return;\n      }\n      console.warn(\n        \"[Warn] you cannot do write operations (Time-travelling, etc) in read-only atoms\\n\",\n        anAtom\n      );\n    };\n    devtools.current = createReduxConnection(extension, atomName);\n    const unsubscribe = devtools.current?.subscribe((message) => {\n      if (message.type === \"ACTION\" && message.payload) {\n        try {\n          setValueIfWritable(JSON.parse(message.payload));\n        } catch (e) {\n          console.error(\n            \"please dispatch a serializable value that JSON.parse() support\\n\",\n            e\n          );\n        }\n      } else if (message.type === \"DISPATCH\" && message.state) {\n        if (message.payload?.type === \"JUMP_TO_ACTION\" || message.payload?.type === \"JUMP_TO_STATE\") {\n          isTimeTraveling.current = true;\n          setValueIfWritable(JSON.parse(message.state));\n        }\n      } else if (message.type === \"DISPATCH\" && message.payload?.type === \"COMMIT\") {\n        devtools.current?.init(lastValue.current);\n      } else if (message.type === \"DISPATCH\" && message.payload?.type === \"IMPORT_STATE\") {\n        const computedStates = message.payload.nextLiftedState?.computedStates || [];\n        computedStates.forEach(({ state }, index) => {\n          if (index === 0) {\n            devtools.current?.init(state);\n          } else {\n            setValueIfWritable(state);\n          }\n        });\n      }\n    });\n    return unsubscribe;\n  }, [anAtom, extension, atomName, setValue]);\n  useEffect3(() => {\n    if (!devtools.current) {\n      return;\n    }\n    lastValue.current = value;\n    if (devtools.current.shouldInit) {\n      devtools.current.init(value);\n      devtools.current.shouldInit = false;\n    } else if (isTimeTraveling.current) {\n      isTimeTraveling.current = false;\n    } else {\n      devtools.current.send(\n        `${atomName} - ${(/* @__PURE__ */ new Date()).toLocaleString()}`,\n        value\n      );\n    }\n  }, [anAtom, extension, atomName, value]);\n}\n\n// src/utils/useAtomsDevtools.ts\nimport { useEffect as useEffect4, useRef as useRef4 } from \"react\";\nvar atomToPrintable2 = (atom) => atom.debugLabel ? `${atom}:${atom.debugLabel}` : `${atom}`;\nvar getDevtoolsState = (atomsSnapshot) => {\n  const values = {};\n  atomsSnapshot.values.forEach((v, atom) => {\n    values[atomToPrintable2(atom)] = v;\n  });\n  const dependents = {};\n  atomsSnapshot.dependents.forEach((d, atom) => {\n    dependents[atomToPrintable2(atom)] = Array.from(d).map(atomToPrintable2);\n  });\n  return {\n    values,\n    dependents\n  };\n};\nfunction useAtomsDevtools(name, options) {\n  const { enabled } = options || {};\n  const extension = getReduxExtension(enabled);\n  const atomsSnapshot = useAtomsSnapshot(options);\n  const goToSnapshot = useGotoAtomsSnapshot(options);\n  const isTimeTraveling = useRef4(false);\n  const isRecording = useRef4(true);\n  const devtools = useRef4();\n  const snapshots = useRef4([]);\n  useEffect4(() => {\n    if (!extension) {\n      return;\n    }\n    const getSnapshotAt = (index = snapshots.current.length - 1) => {\n      const snapshot = snapshots.current[index >= 0 ? index : 0];\n      if (!snapshot) {\n        throw new Error(\"snapshot index out of bounds\");\n      }\n      return snapshot;\n    };\n    devtools.current = createReduxConnection(extension, name);\n    const devtoolsUnsubscribe = devtools.current?.subscribe((message) => {\n      switch (message.type) {\n        case \"DISPATCH\":\n          switch (message.payload?.type) {\n            case \"RESET\":\n              break;\n            case \"COMMIT\":\n              devtools.current?.init(getDevtoolsState(getSnapshotAt()));\n              snapshots.current = [];\n              break;\n            case \"JUMP_TO_ACTION\":\n            case \"JUMP_TO_STATE\":\n              isTimeTraveling.current = true;\n              goToSnapshot(getSnapshotAt(message.payload.actionId - 1));\n              break;\n            case \"PAUSE_RECORDING\":\n              isRecording.current = !isRecording.current;\n              break;\n          }\n      }\n    });\n    return () => {\n      extension?.disconnect?.();\n      devtoolsUnsubscribe?.();\n    };\n  }, [extension, goToSnapshot, name]);\n  useEffect4(() => {\n    if (!devtools.current) {\n      return;\n    }\n    if (devtools.current.shouldInit) {\n      devtools.current.init(void 0);\n      devtools.current.shouldInit = false;\n      return;\n    }\n    if (isTimeTraveling.current) {\n      isTimeTraveling.current = false;\n    } else if (isRecording.current) {\n      snapshots.current.push(atomsSnapshot);\n      devtools.current.send(\n        {\n          type: `${snapshots.current.length}`,\n          updatedAt: (/* @__PURE__ */ new Date()).toLocaleString()\n        },\n        getDevtoolsState(atomsSnapshot)\n      );\n    }\n  }, [atomsSnapshot]);\n}\n\nexport {\n  isDevToolsStore,\n  useDevToolsStore,\n  useAtomsSnapshot,\n  useGotoAtomsSnapshot,\n  useAtomsDebugValue,\n  useAtomDevtools,\n  useAtomsDevtools\n};\n","import {\n  InternalDevTools\n} from \"./chunk-YF3ARTE5.esm.mjs\";\nimport {\n  useAtomDevtools,\n  useAtomsDebugValue,\n  useAtomsDevtools,\n  useAtomsSnapshot,\n  useGotoAtomsSnapshot\n} from \"./chunk-2JP4LGQ6.esm.mjs\";\n\n// src/index.ts\nvar DevTools = process.env.NODE_ENV !== \"production\" ? InternalDevTools : () => null;\nexport {\n  DevTools,\n  useAtomDevtools,\n  useAtomsDebugValue,\n  useAtomsDevtools,\n  useAtomsSnapshot,\n  useGotoAtomsSnapshot\n};\n"],"names":["isStoreV2","store","isStoreV1","isDevToolsStore","__composeV2StoreWithDevTools","sub","set","get","storeListeners","Set","recentlySetAtomsMap","WeakMap","reduceCountOrRemoveRecentlySetAtom","atom","onFound","foundCount","delete","increaseCountRecentlySetAtom","args","unsub","forEach","l","type","value","Promise","then","resolve","subscribeStore","add","getMountedAtoms","dev4_get_mounted_atoms","getAtomState","aState","dev4_get_internal_weak_map","v","e","d","keys","getMountedAtomState","m","t","restoreAtoms","dev4_restore_atoms","values","__composeV1StoreWithDevTools","dev_subscribe_store","dev_get_mounted_atoms","dev_get_atom_state","dev_get_mounted","dev_restore_atoms","action","composeWithDevTools","useDevToolsStore","options","isEqualAtomsValues","left","right","size","Array","from","every","left2","Object","is","isEqualAtomsDependents","a","dLeft","dRight","has","useAtomsSnapshot","shouldShowPrivateAtoms","atomsSnapshot","setAtomsSnapshot","useState","Map","dependents","duringReactRenderPhase","useRef","current","useLayoutEffect","useEffect","prevValues","prevDependents","callback","debugPrivate","atomState","mounted","atomDependents","filter","dependent","deferrableAtomSetAction","unsubscribe","useGotoAtomsSnapshot","useCallback","snapshot","atomToPrintable","debugLabel","toString","stateToPrintable","atoms","fromEntries","flatMap","error","map","useAtomsDebugValue","enabled","setAtoms","useDebugValue","createReduxConnection","extension","name","assign","connect","shouldInit","getReduxExtension","window","__REDUX_DEVTOOLS_EXTENSION__","useAtomDevtools","anAtom","setValue","lastValue","isTimeTraveling","devtools","atomName","setValueIfWritable","value2","console","warn","subscribe","message","payload","JSON","parse","state","init","computedStates","nextLiftedState","index","send","Date","toLocaleString","atomToPrintable2","getDevtoolsState","useAtomsDevtools","goToSnapshot","isRecording","snapshots","getSnapshotAt","length","devtoolsUnsubscribe","actionId","disconnect","push","updatedAt","DevTools"],"sourceRoot":""}