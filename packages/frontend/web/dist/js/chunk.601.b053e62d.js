"use strict";(globalThis.webpackChunk_affine_web=globalThis.webpackChunk_affine_web||[]).push([[601],{39840:(e,t,s)=>{s.d(t,{D:()=>a});var o=s(40274),l=s(86326);let a=()=>{let[e,t]=(0,l.useState)(!1),[s]=(0,o.U)(),a=(0,l.useCallback)((e=!0)=>{let o=s?.host;o&&((()=>{let t=o.spec.getService("affine:page");if(!t)return;let s="frameNavigator"===t.tool.edgelessTool.type;(!e||!s)&&(e||s)&&t.tool.setEdgelessTool({type:e?"frameNavigator":"default"})})(),t(e))},[s?.host,e]);return(0,l.useEffect)(()=>{if(!e)return;let o=s?.host;if(!o)return;let l=o?.querySelector("affine-edgeless-root");if(l)return l.slots.edgelessToolUpdated.on(()=>{t("frameNavigator"===l.edgelessTool.type)}).dispose},[s?.host,e]),{isPresent:e,handlePresent:a}}},48092:(e,t,s)=>{s.d(t,{j:()=>b,H:()=>k});var o=s(36870),l=s(4588),a=s(23110),d=s(94002),n=s(24312),i=s(45483),r=s(10980),c=s(70154),u=s(61569),g=s(86326),f="_2ct5f60",h=s(71344);let p={value:"edgeless",label:(0,o.jsx)(h._,{}),testId:"switch-edgeless-mode-button",className:f},m={value:"page",label:(0,o.jsx)(h.n,{}),testId:"switch-page-mode-button",className:f},b=({pageId:e,isPublic:t,publicMode:s})=>{let f=(0,n.s9)(),h=(0,r.h1)(c.F),p=(0,u.S)(h.list.doc$(e)),m=(0,u.S)(p?.trash$),b=(0,u.S)(p?.mode$),v=(0,g.useCallback)(()=>{"page"===b||t||m||(p?.setMode("page"),(0,l.oR)(f["com.affine.toastMessage.pageMode"]()),d.u4.$.header.actions.switchPageMode({mode:"page"}))},[b,p,t,f,m]),S=(0,g.useCallback)(()=>{"edgeless"===b||t||m||(p?.setMode("edgeless"),(0,l.oR)(f["com.affine.toastMessage.edgelessMode"]()),d.u4.$.header.actions.switchPageMode({mode:"edgeless"}))},[b,p,t,f,m]),w=(0,g.useCallback)(e=>{"page"===e?v():S()},[S,v]),y=(0,g.useCallback)(e=>m&&b!==e||t&&s!==e,[b,t,s,m]);return(0,g.useEffect)(()=>{if(!m&&!t&&void 0!==b)return(0,a.uu)({id:"affine:doc-mode-switch",category:"editor:page",label:"page"===b?f["com.affine.cmdk.switch-to-edgeless"]():f["com.affine.cmdk.switch-to-page"](),icon:"page"===b?(0,o.jsx)(i.EdgelessIcon,{}):(0,o.jsx)(i.PageIcon,{}),keyBinding:{binding:"Alt+KeyS",capture:!0},run:()=>w("edgeless"===b?"page":"edgeless")})},[b,t,w,f,m]),(0,o.jsx)(l.m_,{content:f.Switch(),shortcut:["$alt","S"],side:"bottom",options:{hidden:t||m},children:(0,o.jsx)("div",{children:(0,o.jsx)(k,{mode:b,setMode:w,hidePage:y("page"),hideEdgeless:y("edgeless")})})})},k=({mode:e,setMode:t,hidePage:s,hideEdgeless:a})=>{let d=(0,g.useMemo)(()=>[...s?[]:[m],...a?[]:[p]],[a,s]);return(0,o.jsx)(l.z6,{iconMode:!0,itemHeight:24,borderRadius:8,padding:4,gap:8,value:e,items:d,onChange:t})}},45609:(e,t,s)=>{s.d(t,{q:()=>b});var o=s(36870),l=s(43392),a=s(71006),d=s(69050),n=s(61569),i=s(10980),r=s(58507),c=s(51520),u=s(37064),g=s(86326),f=s(42277),h=s(6503),p=s(43685);let m=(0,g.memo)(function({page:e,onLoad:t,isPublic:s,publishMode:l}){let m=(0,n.S)((0,i.h1)(r.s).doc.mode$),b=(0,g.useMemo)(()=>{let e=l||m;return s?e:m},[s,l,m]),{appSettings:k}=(0,h.V)(),v=(0,g.useMemo)(()=>{let e=c.r1.find(e=>e.key===k.fontStyle);return(0,a.Z1)(e),e.value},[k.fontStyle]),S=(0,f.zy)().hash.substring(1),w=(0,g.useCallback)(s=>{globalThis.currentEditor=s;let o=new d.K;return localStorage.setItem("last_page_id",e.id),t&&s.updateComplete.then(()=>s.host?.updateComplete).then(()=>{o.add(t(e,s))}).catch(console.error),()=>{o.dispose()}},[t,e]);return(0,o.jsx)(p.H,{className:(0,u.A)("_1ggq7uq0",{"full-screen":!s&&k.fullWidthLayout,"is-public":s}),style:{"--affine-font-family":v},mode:b,page:e,shared:s,defaultSelectedBlockId:S,onLoadEditor:w})}),b=e=>{let{docCollection:t,pageId:s}=e,a=(0,l.D)(t,s);return a?(0,o.jsx)(g.Suspense,{children:(0,o.jsx)(m,{...e,page:a})}):null}},43392:(e,t,s)=>{s.d(t,{D:()=>n});var o=s(52490),l=s(69050),a=s(86326);let d=new o.k("use-doc-collection-page");function n(e,t){let[s,o]=(0,a.useState)(t?e.getDoc(t):null);return(0,a.useEffect)(()=>{let s=new l.K;return s.add(e.slots.docAdded.on(s=>{t===s&&o(e.getDoc(s))})),s.add(e.slots.docRemoved.on(e=>{t===e&&o(null)})),()=>{s.dispose()}},[e,t]),(0,a.useEffect)(()=>{if(s&&!s.loaded)try{s.load()}catch(e){d.error("Failed to load page",e)}},[s]),s}},90039:(e,t,s)=>{s.d(t,{k:()=>a});var o=s(57530),l=s(86326);function a(e){var t;t=e?`${e} \xb7 AFFiNE`:null,(0,l.useEffect)(()=>{if(environment.isDesktop||!t)return o.A;let e=document.title;return document.title=t,()=>{document.title=e}},[t])}}}]);
//# sourceMappingURL=chunk.601.b053e62d.js.map